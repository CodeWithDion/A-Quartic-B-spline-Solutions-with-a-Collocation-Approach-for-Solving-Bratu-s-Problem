syms x 
format long
delta_x=1/30;
n=29;
h=1/30;
lamda = 2;
f = @(teta) teta - (sqrt(2.*lamda).*cosh(teta/4));
dfdteta = @(teta) 1 - (sqrt(2.*lamda).*sinh(teta/4))/4;
e = 10.^-4;
teta0 = 0;

%%% Newton Raphson for Calculate the value of Teta in the Exact Solution %%%
for i=1:100
   
    teta = teta0 - f(teta0)/dfdteta(teta0);

    if abs(f(teta))<e
        break
    end
    teta0=teta;

end

%%% Calculate the Value of X for every iterations %%%
for i=1:33

    x(i)=(-2+i).*delta_x;

end


%%%% Calculate The Exact and Approximation Solutions %%%%
disp('  x      Exact Solution         S(x)            Error')

for j=1:n

   
    u =-2.*log(cosh((x(j+2)-1/2).*teta/2)/cosh(teta/4));

       B(j) = ((x(j+2)-x(j+2)).^4)/(24*h.^4);
       B(1+j) = ((x(j+2)-x(j+3)).^4)/(24*h.^4);
       B(2+j) = ((x(j+2)-x(j+4)).^4 - 5.*(x(j+2)-x(j+3)).^4)/(24*h.^4);
       B(3+j) = ((x(j+2)-x(j)).^4 - 5.*(x(j+2)-x(j+1)).^4)/(24*h.^4);
       B(4+j) = ((x(j+1)-x(j+2)).^4)/(24*h.^4);
       B(5+j) = ((x(j+2)-x(j+2)).^4)/(24*h.^4);
       B(6+j) = 0;
       B(7+j) = 0;
       B(8+j) = 0;
       B(9+j) = 0;
       B(10+j) = 0;
       B(11+j) = 0;
       B(12+j) = 0;
       B(13+j) = 0;
       B(14+j) = 0;
       B(15+j) = 0;
       B(16+j) = 0;
       B(17+j) = 0;
       B(18+j) = 0;
       B(19+j) = 0;
       B(20+j) = 0;
       B(21+j) = 0;
       B(22+j) = 0;
       B(23+j) = 0;
       B(24+j) = 0;
       B(25+j) = 0;
       B(26+j) = 0;
       B(27+j) = 0;
       B(28+j) = 0;
       B(29+j) = 0;
       B(30+j) = 0;
       B(31+j) = 0;
       B(32+j) = 0;
       B(33+j) = 0;

       S = - 0.064424784507670.*B(1) - 0.020626159135757.*B(2) + 0.020996529506127.*B(3) + 0.060350710433596.*B(4) + 0.097345348852197.*B(5)...
           + 0.131891427024045.*B(6) + 0.163902898442285.*B(7) + 0.193297221873061.*B(8) + 0.219996347059786.*B(9) + 0.243927255671701.*B(10)...
           + 0.265022926816006.*B(11) + 0.283222828891637.*B(12) + 0.298473806125932.*B(13) + 0.310730461546347.*B(14) + 0.319955905741218.*B(15)...
           + 0.326121975249343.*B(16) + 0.329209793073505.*B(17) + 0.329209779270162.*B(18) + 0.326121989052686.*B(19) + 0.319955891937875.*B(20)...
           + 0.310730475349690.*B(21) + 0.298473792322590.*B(22) + 0.283222842694980.*B(23) + 0.265022913012663.*B(24) + 0.243927269475043.*B(25)...
           + 0.219996333256444.*B(26) + 0.193297235676403.*B(27) + 0.163902884638943.*B(28) + 0.131891440827387.*B(29) + 0.097345335048855.*B(30)...
           + 0.060350724236938.*B(31) + 0.020996515702785.*B(32) - 0.020626145332415.*B(33) - 0.064424798311012.*B(34);


    Error = abs(u-S);
    m=[x(j+2);u;S;Error];
    fprintf('%3.2f   %3.15f   %3.15f   %3.15e\n',m);
end